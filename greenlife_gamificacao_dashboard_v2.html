<div style="max-width:1100px;margin:20px auto;font-family:system-ui,Arial;">
  <h2 style="margin:8px 0;">Resultados (ao vivo da planilha)</h2>
  <div id="tabela" style="overflow:auto;border:1px solid #ddd;border-radius:8px;"></div>
</div>

<script>
  // Seu CSV público:
  const URL_CSV = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRwUmtRBRPis65TuPuubKW9-XL7G7RUbtsp9RI5fjBtZXTmti5A2Ro71tdg0NIJCjhBVYp3jk-DqEoM/pub?gid=59695337&single=true&output=csv';

  // Busca SEM cache (força atualização sempre que abrir/atualizar a página)
  async function fetchCSV(url) {
    const sep = url.includes('?') ? '&' : '?';
    const finalUrl = `${url}${sep}t=${Date.now()}`;
    const res = await fetch(finalUrl, { cache: 'no-store', headers: { 'Cache-Control': 'no-cache' } });
    if (!res.ok) throw new Error('Falha ao baixar CSV: ' + res.status);
    return res.text();
  }

  // Parse simples de CSV (ok se não houver vírgulas dentro das células)
  function parseCSV(text) {
    return text.trim().split(/\r?\n/).map(l => l.split(','));
  }

  function renderTable(rows, containerId) {
    const el = document.getElementById(containerId);
    if (!rows.length) { el.textContent = 'Sem dados.'; return; }

    const table = document.createElement('table');
    table.style.width = '100%';
    table.style.borderCollapse = 'collapse';
    table.style.fontSize = '14px';

    rows.forEach((row, i) => {
      const tr = document.createElement('tr');
      row.forEach(cell => {
        const td = document.createElement(i === 0 ? 'th' : 'td');
        td.textContent = cell;
        td.style.padding = '10px';
        td.style.borderBottom = '1px solid #eee';
        if (i === 0) { td.style.textAlign = 'left'; td.style.background = '#f8f8f8'; }
        tr.appendChild(td);
      });
      table.appendChild(tr);
    });

    el.innerHTML = '';
    el.appendChild(table);
  }

  async function carregar() {
    try {
      const csv = await fetchCSV(URL_CSV);
      const rows = parseCSV(csv);
      renderTable(rows, 'tabela');
    } catch (e) {
      console.error(e);
      document.getElementById('tabela').textContent = 'Erro ao carregar dados.';
    }
  }

  document.addEventListener('DOMContentLoaded', carregar);

  // (Opcional) Atualiza sozinho a cada 2 minutos:
  // setInterval(carregar, 2 * 60 * 1000);
</script>
</body>
</html>

