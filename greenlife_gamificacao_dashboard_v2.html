<div style="max-width:1100px;margin:20px auto;font-family:system-ui,Arial;">
  <h2 style="margin:8px 0;">Ranking Semanal</h2>
  <div id="tabela-semanal" style="overflow:auto;border:1px solid #ddd;border-radius:8px;"></div>

  <h2 style="margin:24px 0 8px;">Ranking Mensal</h2>
  <div id="tabela-mensal" style="overflow:auto;border:1px solid #ddd;border-radius:8px;"></div>
</div>

<script>
  // COLE AQUI OS LINKS CSV publicados nas abas
  const URL_SEMANAL = 'COLE_AQUI_A_URL_CSV_DA_ABA_Export_SEMANAL_CSV';
  const URL_MENSAL  = 'COLE_AQUI_A_URL_CSV_DA_ABA_Export_MENSAL_CSV';

  // Busca o CSV sempre “fresco”: sem cache + um parâmetro único (?t=...)
  async function fetchCSV(url) {
    const sep = url.includes('?') ? '&' : '?';
    const noCacheUrl = `${url}${sep}t=${Date.now()}`;
    const res = await fetch(noCacheUrl, { cache: 'no-store', headers: { 'Cache-Control': 'no-cache' } });
    if (!res.ok) throw new Error('Erro ao baixar CSV: ' + res.status);
    return res.text();
  }

  // Parse simples de CSV (se tiver vírgulas dentro de célula, me avise que mando versão com PapaParse)
  function parseCSV(text) {
    return text.trim().split(/\r?\n/).map(l => l.split(','));
  }

  function renderTable(rows, containerId) {
    const el = document.getElementById(containerId);
    if (!rows.length) { el.textContent = 'Sem dados.'; return; }

    const table = document.createElement('table');
    table.style.width = '100%';
    table.style.borderCollapse = 'collapse';
    table.style.fontSize = '14px';

    rows.forEach((row, i) => {
      const tr = document.createElement('tr');
      row.forEach(cell => {
        const td = document.createElement(i === 0 ? 'th' : 'td');
        td.textContent = cell;
        td.style.padding = '10px';
        td.style.borderBottom = '1px solid #eee';
        if (i === 0) { td.style.textAlign = 'left'; td.style.background = '#f8f8f8'; }
        tr.appendChild(td);
      });
      table.appendChild(tr);
    });

    el.innerHTML = '';
    el.appendChild(table);
  }

  async function loadAll() {
    try {
      const sem = await fetchCSV(URL_SEMANAL);
      renderTable(parseCSV(sem), 'tabela-semanal');
    } catch (e) {
      console.error(e);
      document.getElementById('tabela-semanal').textContent = 'Erro ao carregar semanal.';
    }

    try {
      const men = await fetchCSV(URL_MENSAL);
      renderTable(parseCSV(men), 'tabela-mensal');
    } catch (e) {
      console.error(e);
      document.getElementById('tabela-mensal').textContent = 'Erro ao carregar mensal.';
    }
  }

  document.addEventListener('DOMContentLoaded', loadAll);
  // (Opcional) Atualizar sozinho a cada 5 minutos:
  // setInterval(loadAll, 5 * 60 * 1000);
</script>
</body>
</html>

